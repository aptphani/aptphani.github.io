document.addEventListener('dblclick', (event) => {
  event.preventDefault();
  mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
  mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
  raycaster.setFromCamera(mouse, camera);

  const intersects = raycaster.intersectObjects(scene.children, true);

  if (intersects.length > 0) {
    const intersectedObject = intersects.find(intersect => intersect.object === cube || cube.children.includes(intersect.object));

    if (intersectedObject) {
      // Assuming you have some way to determine the face's name/identifier
      // This example assumes the intersected object or its parent has userData with a face name
      let faceNameText = "Unknown Face"; // Default text if face name is not found
      if (intersectedObject.object.userData && intersectedObject.object.userData.name) {
        faceNameText = intersectedObject.object.userData.name; // Use the actual face name
      } else if (intersectedObject.object.parent && intersectedObject.object.parent.userData.name) {
        // If the intersected object is part of a group, you might need to check the parent's userData
        faceNameText = intersectedObject.object.parent.userData.name;
      }

      // Check if a canvas already exists, if not, create one
      let canvas = modal.querySelector('canvas');
      if (!canvas) {
        canvas = document.createElement('canvas');
        canvas.width = 200; // Set your desired width
        canvas.height = 100; // Set your desired height
        modal.appendChild(canvas);
      }

      const ctx = canvas.getContext('2d');

      // Clear the canvas in case it's being reused
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Set text properties
      ctx.font = '18px Arial';
      ctx.fillStyle = 'black';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';

      // Draw the actual face name on the canvas
      ctx.fillText("Clicked Face: " + faceNameText, canvas.width / 2, canvas.height / 2);

      // Move the cube to the new position before showing the modal
      new TWEEN.Tween(cube.position)
        .to({ x: -20, y: 10, z: -50 }, 1000)
        .easing(TWEEN.Easing.Exponential.InOut)
        .onComplete(() => {
            // Display the modal after the cube has finished moving
            modal.style.display = 'block';
        })
        .start();
    }
  }
});
